<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>우리가족지킴이</title>
    <link href="/css/user.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.2/dist/umd/popper.min.js" crossorigin="anonymous"></script>
    <script th:src="@{/js/date.js}" crossorigin="anonymous" type="text/javascript"></script>
    <link href="https://cdn.jsdelivr.net/gh/Eonasdan/tempus-dominus@master/dist/css/tempus-dominus.css" rel="stylesheet" crossorigin="anonymous">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.1.1/css/all.min.css" rel="stylesheet">
    <link href="../assets/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous">
</head>
<body>
<div class="cover-container d-flex w-100 h-100 p-3 mx-auto flex-column">
    <header>
        <div>
            <h3 class="float-md-start mb-0"></h3>
            <nav class="nav nav-masthead justify-content-center float-md-end">
                <a class="nav-link" href="http://124.60.219.83:8080/">Home</a>
                <a class="nav-link" href="http://124.60.219.83:8080/features">Features</a>
                <a class="nav-link" href="http://124.60.219.83:8080/contact">Contact</a>
                <a class="nav-link" href="javascript:void(0)" onclick="kakaoLogout();">Logout</a>
            </nav>
        </div>
    </header>
    <hr style="border: 0px; height: 0px;">
    <form method="get" action="/search/web">
        <div class='input-group' id='datetimepicker1' data-td-target-input='nearest' data-td-target-toggle='nearest'>
            <input id='datetimepicker1Input' name="datetimepicker1Input" type='text' class='form-control' data-td-target='#datetimepicker1' />
            <span class='input-group-text' data-td-target='#datetimepicker1' data-td-toggle='datetimepicker'>
                    <span class='fa fa-solid fa-calendar'></span>
                </span>
            <input type="hidden" id="id" name="id" value=""/>
            <input type="submit" class="btn btn-outline-success" value="날짜 조회"/>
        </div>
    </form>
        <table class="table table-success table-striped">
            <tr>
                <th>기기 id</th>
                <th>시간</th>
                <th>방향</th>
            </tr>
            <tr th:each="testobj : ${test}">
                <td th:text="${testobj.device}">기기 id</td>
                <td th:text="${testobj.date}">시간</td>
                <td th:text="${testobj.state}">방향</td>
            </tr>
        </table>
    </div>
<script>
            new tempusDominus.TempusDominus(document.getElementById('datetimepicker1'), {
            display: {
                components: {
                    seconds: false,
                },
                icons: {
                    type: 'icons',
                    date: 'fa fa-solid fa-calendar',
                    up: 'fa fa-solid fa-arrow-up',
                    down: 'fa fa-solid fa-arrow-down',
                    previous: 'fa fa-solid fa-chevron-left',
                    next: 'fa fa-solid fa-chevron-right',
                    today: 'fa fa-solid fa-calendar-check',
                    clear: 'fa fa-solid fa-trash',
                    close: 'fas fa-solid fa-xmark'
                },
            },
        });
        </script>
<footer class="mt-auto text-black text-center">
    <p>Cover 2022, Gavengers Allrights reserved </p>
</footer>
</body>
</html>
<script src="https://developers.kakao.com/sdk/js/kakao.js"></script>
<script>
    Kakao.init('9277d84d6be1847891be44f1fc984517');
    console.log(Kakao.isInitialized());
    function kakaoLogout() {
        if (Kakao.Auth.getAccessToken()) {
            Kakao.API.request({
                url: '/v1/user/unlink',
                success: function (response) {
                    console.log(response)
                    location.href = 'http://124.60.219.83:8080'
                },
                fail: function (error) {
                    console.log(error)
                },
            })
            Kakao.Auth.setAccessToken(undefined)
        }
    }
    function getInfo() {
        Kakao.API.request({
            url: '/v2/user/me',
            success: function (res) {
                // 이메일, 성별, 닉네임, 프로필이미지
                var id = res.id;
                document.getElementById("id").value = parseInt(id);
                console.log(id);
            }
        });
    }
    window.onload = getInfo();
</script>